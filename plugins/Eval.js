var ApplicationCommandSectionType;(function(e){e[e.BuiltIn=0]="BuiltIn",e[e.Guild=1]="Guild",e[e.DM=2]="DM"})(ApplicationCommandSectionType||(ApplicationCommandSectionType={}));var ApplicationCommandType;(function(e){e[e.Chat=1]="Chat",e[e.User=2]="User",e[e.Message=3]="Message"})(ApplicationCommandType||(ApplicationCommandType={}));var ApplicationCommandInputType;(function(e){e[e.BuiltIn=0]="BuiltIn",e[e.BuiltInText=1]="BuiltInText",e[e.BuiltInIntegration=2]="BuiltInIntegration",e[e.Bot=3]="Bot",e[e.Placeholder=4]="Placeholder"})(ApplicationCommandInputType||(ApplicationCommandInputType={}));var ApplicationCommandPermissionType;(function(e){e[e.Role=1]="Role",e[e.User=2]="User"})(ApplicationCommandPermissionType||(ApplicationCommandPermissionType={}));var ApplicationCommandOptionType;(function(e){e[e.SubCommand=1]="SubCommand",e[e.SubCommandGroup=2]="SubCommandGroup",e[e.String=3]="String",e[e.Integer=4]="Integer",e[e.Boolean=5]="Boolean",e[e.User=6]="User",e[e.Channel=7]="Channel",e[e.Role=8]="Role",e[e.Mentionnable=9]="Mentionnable",e[e.Number=10]="Number"})(ApplicationCommandOptionType||(ApplicationCommandOptionType={}));var InteractionTypes;(function(e){e[e.ApplicationCommand=2]="ApplicationCommand",e[e.MessageComponent=3]="MessageComponent"})(InteractionTypes||(InteractionTypes={}));const EnmitySectionID="enmity";function registerPlugin(e){window.enmity.plugins.registerPlugin(e)}function sendReply(e,n,s,t){window.enmity.clyde.sendReply(e,n,s,t)}async function evaluate(src,isAsync=!1){let result,errored;(isAsync||src.includes("await"))&&(src.includes(";")&&(!src.endsWith(";")||src.includes(`
`)||src.split(";").length>2)?src=`(async () => { ${src} })()`:src=`(async () => { return ${src} })()`);let start=new Date().getTime();try{result=eval(src),result instanceof Promise&&(result=await result)}catch(e){result=e,errored=!0}let elapsed=new Date().getTime()-start;return[errored,result,elapsed]}const EvalPlugin={name:"Eval",commands:[],onStart(){const e={id:"sync-eval-command",applicationId:EnmitySectionID,name:"eval",displayName:"eval",description:"Evaluates JS",displayDescription:"Evaluates JS. DO NOT RUN WHAT YOU DO NOT UNDERSTAND.",type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltInText,options:[{name:"src",displayName:"src",description:"code to evaluate",displayDescription:"code to evaluate",type:ApplicationCommandOptionType.String,required:!0}],execute:async function(s,t){const r=s[0].value,[a,l,u]=await evaluate(r);sendReply(t.channel.id,[`${a?"Failed executing":"Successfully executed"} in ${u}ms`,`\`\`\`js
${l}
\`\`\``].join(`
`))}},n={id:"async-eval-command",applicationId:EnmitySectionID,name:"eval async",displayName:"eval async",description:"Evaluates JS synchronously",displayDescription:"Evaluates JS synchronously. DO NOT RUN WHAT YOU DO NOT UNDERSTAND.",type:ApplicationCommandType.Chat,inputType:ApplicationCommandInputType.BuiltInText,options:[{name:"src",displayName:"src",description:"code to evaluate",displayDescription:"code to evaluate",type:ApplicationCommandOptionType.String,required:!0}],execute:async function(s,t){const r=s[0].value,[a,l,u]=await evaluate(r,!0);sendReply(t.channel.id,[`${a?"Failed executing":"Successfully executed"} in ${u}ms`,`\`\`\`js
${l}
\`\`\``].join(`
`))}};this.commands.push(e),this.commands.push(n)},onStop(){this.comamands=[]}};registerPlugin(EvalPlugin);
